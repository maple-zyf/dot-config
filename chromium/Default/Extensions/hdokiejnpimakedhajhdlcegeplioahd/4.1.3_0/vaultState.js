VaultState={};
(function(){var d=null,b=null,h=null,c=null,e=null,f=null,g=function(a){LPTools.getOption(a,"incrementAccountsVersion",!1)&&(a=LPTools.getOption(a,"incrementAccountsVersionAmount",1),b+=a)};Topics.get(Topics.IDENTITY_ENABLE).subscribe(function(a){d=a.getID()});Topics.get(Topics.REQUEST_SUCCESS).subscribe(function(a){g(a.requestSuccessOptions)});Topics.get(Topics.UPDATE_VAULT_STATE).subscribe(g);VaultState.incrementAccountsVersion=function(){++b};VaultState.setAccountsVersion=function(a){b=a};VaultState.setIdentities=
function(a){e=a};var j=function(a){return bg&&bg.lploggedin&&-1<bg.g_local_accts_version&&LPPlatform.loadedPreferences()?(d=bg.g_identity,b=parseInt(bg.g_local_accts_version),h=bg.g_showcredmon,Topics.get(Topics.LOGIN).publish({fadeIn:void 0===a?!0:a}),clearInterval(f),f=setInterval(function(){if(bg.lploggedin){if(e&&bg.g_identity!==d){d=bg.g_identity;for(var a=0,g=e.length;a<g;++a)d===e[a].getID()&&e[a].enable({reprompt:!1})}a=parseInt(bg.g_local_accts_version);a>b?(b=a,Topics.get(Topics.REFRESH_DATA).publish(),
c=null):b>a?(null===c&&(c=(new Date).getTime()),15E3<(new Date).getTime()-c&&(c=null,b=a)):c=null;h!==bg.g_showcredmon&&(h=bg.g_showcredmon,Topics.get(Topics.REFRESH_PREFERENCES).publish())}else Topics.get(Topics.CLEAR_DATA).publish(),clearInterval(f),f=setInterval(function(){j()},1E3)},1E3),!0):!1};VaultState.startInitializeInterval=function(){j(!1)||(f=setInterval(function(){j()},1E3))}})();
