var ChooseProfileDialog=function(e){Dialog.call(this,e,{nextButtonText:Strings.translateString("Fill"),title:Strings.translateString("Choose Profile and Credit Card"),closeButtonEnabled:!0,maximizeButtonEnabled:!0})};ChooseProfileDialog.prototype=Object.create(Dialog.prototype);ChooseProfileDialog.prototype.constructor=ChooseProfileDialog;
(function(){ChooseProfileDialog.prototype.initialize=function(){Dialog.prototype.initialize.apply(this,arguments);this.profileElement=$("#profileContainer");this.creditElement=$("#creditCardContainer")};var e=function(b,a,c,d){a=LPTools.buildRadioButton(a,void 0,b.getName());a.children[0].setAttribute("ffid",b.getID());if(0===c.children().length||b.getID()===d)a.children[0].checked=!0;c.append(a)};ChooseProfileDialog.prototype.setup=function(){Dialog.prototype.setup.apply(this,arguments);var b=LPProxy.getFormFillModels();
this.profileElement.empty();this.creditElement.empty();for(var a=bg.lpGetPref(FormFill.prototype.FORM_FILL_TYPE_GENERIC+"ffid"),c=bg.lpGetPref(FormFill.prototype.FORM_FILL_TYPE_CREDIT_CARD+"ffid"),d=0,g=b.length;d<g;++d){var f=b[d];f._data.profiletype!==FormFill.prototype.FORM_FILL_TYPE_CREDIT_CARD&&e(f,"selectedProfile",this.profileElement,a);f._data.ccnum&&e(f,"selectedCreditCard",this.creditElement,c)}};ChooseProfileDialog.prototype.handleSubmit=function(b){var a=this.profileElement.find(".radio:checked").attr("ffid");
bg.lpPutUserPref(FormFill.prototype.FORM_FILL_TYPE_GENERIC+"ffid",a);var c=this.creditElement.find(".radio:checked").attr("ffid");bg.lpPutUserPref(FormFill.prototype.FORM_FILL_TYPE_CREDIT_CARD+"ffid",c);bg.lpPutUserPref("alwayschooseprofilecc",b.alwaysChoose?1:0);bg.lpWriteAllPrefs();this.data.tabID?(bg.fillform(a,!1,this.data.tabID,c),this.close()):bg.get_selected_tab_data(null,function(b){bg.fillform(a,!1,b.id,c);this.close()})}})();
