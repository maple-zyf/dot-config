var RepromptDialog=function(f){Dialog.call(this,f,{additionalHeaderClasses:["icon","leftIcon"],dynamicHeight:!0,responsive:!1,nextButtonText:Strings.translateString("Continue"),title:Strings.translateString("Reprompt"),confirmOnClose:!1});this.numfailed=0};RepromptDialog.prototype=Object.create(Dialog.prototype);RepromptDialog.prototype.constructor=RepromptDialog;
(function(){var f=Strings.translateString("Invalid Password.");RepromptDialog.prototype.open=function(a){this.numfailed=0;Dialog.prototype.open.call(this,$.extend(a,{defaultData:{delayRepromptTime:bg.lpGetPref("reprompttime","0")}}))};RepromptDialog.prototype.initialize=function(a){Dialog.prototype.initialize.apply(this,arguments);var b=this;b.inputFields.delayRepromptTime.onChange(function(a){0<parseInt(a)?b.inputFields.delayReprompt.setValue(!0):b.inputFields.delayReprompt.setValue(!1)});b.inputFields.delayReprompt.onChange(function(a){a||
b.inputFields.delayRepromptTime.setValue("0")})};RepromptDialog.prototype.handleSubmit=function(a){var b=LPProxy.getNewRequestID();Topics.get(Topics.REQUEST_START).publish({requestID:b});var g=bg.get_key_iterations(bg.g_username);bg.make_lp_key_hash_iterations(bg.g_username,a.password,g,function(c,e,d){return function(g){if(g===LPProxy.getLocalKey()){e.lpPutUserPref("reprompttime",a.delayRepromptTime);e.lpWriteAllPrefs();e.set_last_reprompt_time();c.data.selectPreviousTab&&e.select_selectedtabid();
try{"function"===typeof c.data.successCallback?c.data.successCallback():e.repromptSuccess()}catch(h){LPPlatform.logException(h)}d.get(d.REQUEST_SUCCESS).publish({requestID:b})}else d.get(d.ERROR).publish(f),d.get(d.REQUEST_ERROR).publish({requestID:b}),2>c.numfailed?(c.numfailed++,c.inputFields.password.focus()):c.close()}}(this,bg,Topics))}})();
