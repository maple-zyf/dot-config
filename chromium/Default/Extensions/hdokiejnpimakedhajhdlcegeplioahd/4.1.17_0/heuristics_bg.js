function get_SAED_username_password_fields(c,j){function e(a){r&&console_log(a)}var f=[];if(!c)return f;j||(j={});var b=[],f=getBG(),g=null,h=null,r=!1;if(!c.save_all||!c.fields||0===c.fields.length)return[getusernamefromacct(c),getpasswordfromacct(c)];var d=[[50,50],[-50,-50],[-5,25],[5,-25],[10,-10],[-5,10],[5,-10],[-30,-30],[7,7],[1,-10],[-20,-20],[-20,-20]],l=null,n=null,s=RegExp(get_ff_translation("ff_username_regexp")),t=RegExp(get_ff_translation("ff_password_regexp")),u=RegExp(get_ff_translation("ff_email_regexp")),
v=RegExp(get_ff_translation("ff_captcha_regexp")),w=RegExp(get_ff_translation("ff_combineddummy_regexp")),x=RegExp(get_ff_translation("ff_search_regexp")),b=[],a,p=c.fields.length;for(a=0;a<p;a++)b[a]={USCORE:0,PSCORE:0};for(a=0;a<p;a++){var m=c.fields[a].type,q=c.fields[a].value,k=c.fields[a].name;if(null===q||""===q)e(sprintf("[%d] %s VALUE:EMPTY",a,c.fields[a].name)),b[a].USCORE+=d[1][0],b[a].PSCORE+=d[1][1];s.exec(k)&&(e(sprintf("[%d] %s NAME:USERNAME",a,c.fields[a].name)),b[a].USCORE+=d[4][0],
b[a].PSCORE+=d[4][1]);t.exec(k)&&(e(sprintf("[%d] %s NAME:PASSWORD",a,c.fields[a].name)),b[a].USCORE+=d[5][0],b[a].PSCORE+=d[5][1]);u.exec(k)&&(e(sprintf("[%d] %s NAME:EMAIL",a,c.fields[a].name)),b[a].USCORE+=d[6][0],b[a].PSCORE+=d[6][1]);if(v.exec(k)||w.exec(k)||x.exec(k))e(sprintf("[%d] %s NAME:IGNORE",a,c.fields[a].name)),b[a].USCORE+=d[7][0],b[a].PSCORE+=d[7][1];"password"==m?(e(sprintf("[%d] %s TYPE:PW_TYPE",a,c.fields[a].name)),null===h&&(b[a].PSCORE+=d[8][1],h=a),b[a].USCORE+=d[2][0],b[a].PSCORE+=
d[2][1]):lp_in_array(m,["text","tel","email","url"])?(e(sprintf("[%d] %s TYPE:TEXT_TYPE",a,c.fields[a].name)),null===g&&(b[a].USCORE+=d[8][0],g=a),b[a].USCORE+=d[3][0],b[a].PSCORE+=d[3][1]):lp_in_array(m,["number"])?(e(sprintf("[%d] %s TYPE:HTML5TEXTISH",a,c.fields[a].name)),b[a].USCORE+=d[9][0],b[a].PSCORE+=d[9][1]):lp_in_array(m,"date month color datetime search range time datetime-local week".split(" "))?(e(sprintf("[%d] %s TYPE:HTML5NONTEXTISH",a,c.fields[a].name)),b[a].USCORE+=d[10][0],b[a].PSCORE+=
d[10][1]):lp_in_array(m,["reset","button","image","file","submit"])&&(e(sprintf("[%d] %s TYPE:HTML4NONTEXTISH",a,c.fields[a].name)),b[a].USCORE+=d[11][0],b[a].PSCORE+=d[11][1]);"j_username"===k?l=a:"j_password"===k&&"password"==m&&(n=a)}null!==l&&null!==n&&(b[l].USCORE+=d[0][0],b[n].PSCORE+=d[0][1]);g=0;d=-Infinity;h=0;l=-Infinity;for(a=0;a<p;a++)e(sprintf("FIELD %d name=%s U=%d/P=%d",a,c.fields[a].name,b[a].USCORE,b[a].PSCORE)),b[a].USCORE>d&&(d=b[a].USCORE,g=a),b[a].PSCORE>l&&(l=b[a].PSCORE,h=a);
g===h&&1<p&&e("EDGE CASE TODO");b=[];a="";a=is_encrypted_field(c.fields[g].type)?f.lpmdec_acct(c.fields[g].value,!0,c,f.g_shares):c.fields[g].value;null===a&&(a="");e(sprintf("username: guessed %s/%s",c.fields[g].name,a));b.push(a);a=is_encrypted_field(c.fields[h].type)?f.lpmdec_acct(c.fields[h].value,!0,c,f.g_shares):c.fields[h].value;null===a&&(a="");e(sprintf("password: guessed %s/%s",c.fields[h].name,g_show_pw_in_logs?a:"<REDACTED>"));b.push(a);return b}
function value_is_masked(c){if(!c||"string"!=typeof c)return!1;var j=encodeURIComponent(c);return 0<=c.indexOf("***")||0<=j.indexOf("%E2%80%A2%E2%80%A2%E2%80%A2")}
function formdata_has_masked_values(c){if(!c)return!1;c="undefined"!=typeof c?c.split("\n"):[];for(var j=0;j<c.length;j++){var e=c[j].split("\t");if(!(4!=e.length&&5!=e.length)){decodeURIComponent(e[1]);var f=decodeURIComponent(e[2]),e=decodeURIComponent(e[4]);if(value_is_masked(f)&&"notseen"!=e)return console_warn("detected masked field value: "+f),!0}}return!1};
