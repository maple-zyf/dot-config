User=function(e,c,b){this._username=e;this._accountClass=c;this._userMenuText=this._element=null;this._identities=b;this._identityDropdown=null;var a=this;a.identityEnableCallback=function(b){a._identityDropdown&&a._identityDropdown.setValue(b._data.deciname,!1);a._userMenuText.children().detach();if(b instanceof AllIdentity)a._userMenuText.append(a._userInfo);else{var c=LPTools.createElement("ul","userMenuText");c.appendChild(LPTools.createElement("li","userMenuTextSingle truncateShort",b.getName()));
a._userMenuText.append(c)}};a.identityAddedCallback=function(b){a._identities.push(b);a._identityDropdown?a._identityDropdown.setIdentities(a._identities):a.initializeIdentityDropdown(a._element.get(0).firstChild)};Topics.get(Topics.IDENTITY_ENABLE).subscribe(a.identityEnableCallback);Topics.get(Topics.IDENTITY_ADDED).subscribe(a.identityAddedCallback)};
(function(){User.prototype.destruct=function(){this._element.unbind();this._element.empty();this._userMenuText.empty();Topics.get(Topics.IDENTITY_ENABLE).unsubscribe(this.identityEnableCallback);Topics.get(Topics.IDENTITY_ADDED).unsubscribe(this.identityAddedCallback);this._identityDropdown=this._identities=this._userMenuText=this._element=this._accountClass=this._username=null};var e=function(c,b,a,d,f){f=f||{};f.id=a;f["class"]="menuListItem";a=LPTools.createElement("li");b=LPTools.createElement(b,
f);b.textContent=d;a.appendChild(b);c.appendChild(a);return a};User.prototype.initializeIdentityDropdown=function(c){var b=LPTools.createElement("li","menuListHeader identityDropdownMenuItem");b.appendChild(LPTools.createElement("div",{id:"identityDropdownContainer"}));b.children[0].appendChild(LPTools.createElement("img",{id:"identityDropdownIcon",src:"images/vault_4.0/Identity_Avatar.png"}));var a=LPTools.createElement("div");b.children[0].appendChild(a);var d=LPTools.createElement("input",{id:"identityDropdown",
"class":"dialogInput selectDropdown",type:"text"});a.appendChild(d);c.insertBefore(b,c.firstChild);this._identityDropdown=new IdentityDropdown(d,this._identities);c=0;for(a=this._identities.length;c<a;++c)d=this._identities[c],d._enabled&&this._identityDropdown.setValue(d.getName(),!1);LPPlatform.addEventListener(b,"click",function(a){a.stopPropagation()});$(b.nextElementSibling).addClass("divider")};User.prototype.initialize=function(c,b){var a=LPTools.createElement("ul");this._userInfo=LPTools.createElement("ul",
"userMenuText");this._userInfo.appendChild(LPTools.createElement("li","userMenuTextPrimary truncateShort",this._username));this._userInfo.appendChild(LPTools.createElement("li","userMenuTextSecondary",Strings.translateString(this._accountClass)));b.append(this._userInfo);$(e(a,"div","vaultToggleIcon",Strings.Vault.VAULT_TOGGLE)).bind("click",function(){bg.VaultToggle.toggleVault3_0(window)});$(e(a,"div","accountSettingsIcon",Strings.Vault.ACCOUNT_SETTINGS)).bind("click",function(){Topics.get(Topics.EDIT_SETTINGS).publish()});
$(e(a,"a","helpCenterIcon",Strings.Vault.HELP_CENTER,{href:"https://lastpass.com/support_helpcenter.php",target:"_blank"})).bind("click",function(){window.open("https://lastpass.com/support_helpcenter.php")});$(e(a,"div","logoutIcon",Strings.Vault.LOGOUT)).bind("click",LPProxy.logout);c.append(a);1<this._identities.length&&this.initializeIdentityDropdown(a);this._element=c;this._userMenuText=b};User.prototype.isFree=function(){return this._accountClass===Constants.USER_FREE}})(document);
