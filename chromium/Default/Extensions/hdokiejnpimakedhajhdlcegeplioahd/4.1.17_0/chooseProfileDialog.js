var ChooseProfileDialog=function(e){Dialog.call(this,e,{nextButtonText:Strings.translateString("Fill"),title:Strings.translateString("Choose Form Fill and Credit Card"),closeButtonEnabled:!0,maximizeButtonEnabled:!0})};ChooseProfileDialog.prototype=Object.create(Dialog.prototype);ChooseProfileDialog.prototype.constructor=ChooseProfileDialog;
(function(){ChooseProfileDialog.prototype.open=function(b){Dialog.prototype.open.call(this,$.extend(b,{defaultData:{alwaysChoose:bg.Preferences.get("alwayschooseprofilecc")}}))};ChooseProfileDialog.prototype.initialize=function(){Dialog.prototype.initialize.apply(this,arguments);this.profileElement=$("#profileContainer");this.creditElement=$("#creditCardContainer")};var e=function(b,a,d,c){a=LPTools.buildRadioButton(a,void 0,b.getName());a.children[0].setAttribute("ffid",b.getID());if(0===d.children().length||
b.getID()===c)a.children[0].checked=!0;d.append(a)};ChooseProfileDialog.prototype.setup=function(){Dialog.prototype.setup.apply(this,arguments);var b=LPProxy.getFormFillModels();this.profileElement.empty();this.creditElement.empty();for(var a=bg.Preferences.get(FormFill.prototype.FORM_FILL_TYPE_GENERIC+"ffid"),d=bg.Preferences.get(FormFill.prototype.FORM_FILL_TYPE_CREDIT_CARD+"ffid"),c=0,g=b.length;c<g;++c){var f=b[c];f.isCreditCard()?f._data.ccnum&&e(f,"selectedCreditCard",this.creditElement,d):
e(f,"selectedProfile",this.profileElement,a)}};ChooseProfileDialog.prototype.handleSubmit=function(b){var a={},d=this.profileElement.find(".radio:checked").attr("ffid");a[FormFill.prototype.FORM_FILL_TYPE_GENERIC+"ffid"]=d;var c=this.creditElement.find(".radio:checked").attr("ffid");a[FormFill.prototype.FORM_FILL_TYPE_CREDIT_CARD+"ffid"]=c;a.alwayschooseprofilecc=b.alwaysChoose;bg.Preferences.set(a);this.data.tabID?(bg.fillform(d,!1,this.data.tabID,c),this.close()):bg.get_selected_tab_data(null,function(a){bg.fillform(d,
!1,a.id,c);this.close()})}})();
