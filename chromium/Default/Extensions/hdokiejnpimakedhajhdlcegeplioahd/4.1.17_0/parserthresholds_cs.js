var MAX_INPUTS_HARD=200,MAX_INPUTS_SOFT=100;function LP_exceedInputsThreshold(c){if(!c)return!0;var g=MAX_INPUTS_HARD,d=MAX_INPUTS_SOFT;c=c.getElementsByTagName("input");var b=c.length;if(b>g)return verbose_log("EIT: hard threshold exceed"),!0;if(b<d)return!1;var g=0,a;for(a=0;a<b;a++)if(c[a]){var h=c[a].type;("text"==h||"passwd"==h)&&g++}return g>d?(verbose_log("EIT: soft threshold exceed"),!0):!1}var MAX_FORMS_HARD=20,MAX_FORMS_SOFT=10;
function LP_getFormsThreshold(c){function g(a){if(!a||"undefined"==typeof a.elements||5<=a.elements.length)return!1;for(var b=0;b<a.elements.length&&5>b;b++)if("hidden"!=a.elements[b].type)return!1;return!0}if(!c)return 0;var d=MAX_FORMS_HARD,b=MAX_FORMS_SOFT,a=formcacheget(c,"fakedoc","max-forms-threshold");if(null!=a)return a;var a=c.getElementsByTagName("form"),h=a.length;Checkpoint.assert(h<d,"page has too many forms");if(h>d)g(a[0])&&(g(a[1])&&g(a[d-1]))&&(d*=2);else if(h<b)return formcacheset(c,
"fakedoc","max-forms-threshold",b),b;var f=0,j=RegExp(lpgs("ff_loginform_regexp"),"i"),e;for(e=0;e<h&&e<d;e++)if(a[e]){c&&a[e]&&!a[e].disabled&&f++;if(e>b&&c&&a[e]&&!a[e].disabled){var k=a[e].id;if(j.exec(a[e].name)||j.exec(k))return formcacheset(c,"fakedoc","max-forms-threshold",d),d}if(e>d)break}if(f>b)return formcacheset(c,"fakedoc","max-forms-threshold",b+2),b+2;formcacheset(c,"fakedoc","max-forms-threshold",b);return b}var MAX_FORM_ELEMENTS_HARD=500,MAX_FORM_ELEMENTS_SOFT=100;
function LP_exceedFormElementsThreshold(c,g){if(!c||!g)return!0;var d=MAX_FORM_ELEMENTS_SOFT,b=g.elements,a=b.length;if(a>MAX_FORM_ELEMENTS_HARD)return verbose_log("EFET: hard threshold exceed"),!0;if(a<d)return!1;var h=0,f;for(f=0;f<a;f++)if(b[f]&&b[f]&&(!b[f].disabled&&"FIELDSET"!=b[f].tagName)&&"input"==b[f].tagName){var j=inputs[f].type;("text"==j||"passwd"==j)&&h++}return h>d?(verbose_log("EFET: soft threshold exceed"),!0):!1};
