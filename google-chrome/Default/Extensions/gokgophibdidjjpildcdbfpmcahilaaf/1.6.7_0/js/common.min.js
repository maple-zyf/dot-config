function sentEvent(a,b,c){var a=a?a:"",b=b?b:"",c=c?c:"";try{_gaq.push(["_trackEvent",a,b,c])}catch(d){}}function getLang(a){return chrome.i18n.getMessage(a)}function formatBytes(a){var b,c,d;if(1024>a)return a+"B";for(b="KMGTPEZY",c=1024,d=0;d<b.length;++d){if(1024*c>a)return parseInt(a/c)+"."+parseInt(10*(a/c%1))+" "+b[d]+"B";c*=1024}return"!!!"}function formatTime(a){var b=new Date,c=b.getDate(),d=new Date(a),e=d.getDate();return c==e?d.toLocaleTimeString().replace(/:\d{2}$/,""):d.toLocaleDateString().replace(/\//g,"-")}function formatSpeed(a,b){var c,d;return 1e3>a?"0KB/s":(c=a/1e3,d=b/c,1024>d?Math.round(10*d)/10+"bytes/s":1048576>d?Math.round(10*(d/1024))/10+"KB/s":Math.round(10*(d/1048576))/10+"MB/s")}function formatTimeLeft(a){var b,c,d,e;return 1e3>a?"0s":(b=parseInt(a/864e5),c=parseInt(a/36e5)%24,b?b+"d":(d=parseInt(a/6e4)%60,c?c+"h":(e=parseInt(a/1e3)%60,d?d+"m":e+"s")))}function setTimeLeft(a){a>maxTimeLeftInMs&&(maxTimeLeftInMs=a)}function openOptionPage(){var a=chrome.extension.getURL("options.html");chrome.tabs.query({url:a},function(b){b.length?chrome.tabs.update(b[0].id,{active:!0}):chrome.tabs.create({url:a})})}function openDownloadPage(){chrome.tabs.getAllInWindow(null,function(a){for(var b=0;b<a.length;b++)if(a[b].url==chromeExtURL||a[b].url.indexOf("://downloads/")>-1)return chrome.tabs.update(a[b].id,{selected:!0}),void 0;chrome.tabs.create({url:chromeExtURL,selected:!0},function(){_setIcon("normal")})})}function _setIcon(a){var b,c={normal:"19_normal",setting:"19_normal_setting",complete:"19",blue:"19_blue"};_iconType=a,"setting"==a?setBadgeNum(0):onlyButton()&&(a="blue"),b="icons/"+c[a]+".png",chrome.browserAction.setIcon({path:b})}function onlyButton(){return"true"==localStorage.onlyButton}function copyTextToClipboard(a){var b=$("<textarea/>");b.text(a),$("body").append(b),b.get(0).select(),document.execCommand("copy"),b.remove()}function updatePopupOpenTime(){localStorage.popupLastOpened=Date.now()}function setBadgeNum(a){(0>=a||"false"===localStorage.showIconnumber)&&(a=""),chrome.browserAction.setBadgeBackgroundColor({color:"#93D939"}),chrome.browserAction.setBadgeText({text:a+""})}function _setPreNormal(){setBadgeNum(0),updatePopupOpenTime(),_setIcon("normal")}function browserEvent(a){_setPreNormal(),-1==a.url.indexOf("//downloads/")?openDownloadPage():openOptionPage()}function _setBrowserFun(){if("true"==localStorage.showPreview&&!onlyButton())return _setPopup("popup_manager.html"),void 0;_setPopup("");var a=chrome.extension.getBackgroundPage();chrome.browserAction.onClicked.hasListener(browserEvent)||chrome.browserAction.onClicked.addListener(browserEvent),window!=a&&a.chrome.browserAction.onClicked.removeListener(a.browserEvent)}function _setPopup(a){chrome.browserAction.setPopup({popup:a})}function _setShelf(a){("undefined"==typeof a||onlyButton())&&(a="true"===localStorage.allowGreybar||onlyButton()?!0:!1),chrome.downloads.setShelfEnabled(a)}function langSetInit(a,b){loadDefaultLan(a,function(a){a.extetion_title&&(gLangLib=a),"function"==typeof b&&b(gLangLib)})}function getLang(a){return gLangLib[a]?gLangLib[a]["message"]:chrome.i18n.getMessage(a)}function setLang(){$("[i18n]").each(function(){var a=$(this),b=getLang(a.attr("i18n"));b&&a.text(b)})}function loadDefaultLan(a,b){var c,d=a,e="";try{e=JSON.parse(localStorage.langLib)}catch(f){}return c=function(a){"function"==typeof b&&b(a)},d?(a&&!e?$.get("../_locales/"+d+"/messages.json",function(a){var b=a||{};b.extetion_title&&(e=b,localStorage.langLib=JSON.stringify(b),c(e))},"json"):c(e),void 0):(localStorage.removeItem("langLib"),c({}),void 0)}var _iconType,maxTimeLeftInMs,chromeExtURL="chrome://downloads/",timeCount=0;window.gLangLib={},maxTimeLeftInMs=0;